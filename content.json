[{"title":"JDKæºç é˜…è¯»-Iterableä¸Iterator","date":"2018-04-21T16:18:01.000Z","path":"2018/04/22/JDKæºç é˜…è¯»-Iterableä¸Iterator/","text":"JDKæºç é˜…è¯»-Iterableä¸Iterator JDKç‰ˆæœ¬ï¼šjdk1.8.0_121,æœ¬æ–‡ä¸­æ‰€æœ‰ä»£ç çš„ç¼–è¯‘å’Œè¿è¡Œç¯å¢ƒå‡ä¾èµ–è¯¥ç‰ˆæœ¬çš„jdkå’Œå¯¹åº”ç‰ˆæœ¬çš„jre 1.ä»€ä¹ˆæ˜¯Iterable1.1ç®€ä»‹Iterableæ˜¯Javaé›†åˆä¸­çš„ä¸€ä¸ªé¡¶çº§æ¥å£ï¼Œæ˜¯Collectionçš„çˆ¶ç±»ï¼Œç”¨äºè¿›è¡Œé›†åˆä¸­å…ƒç´ çš„è¿­ä»£ã€‚Iterableçš„æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š 12345678910111213141516171819package java.lang;import ...public interface Iterable&lt;T&gt; &#123; Iterator&lt;T&gt; iterator(); default void forEach(Consumer&lt;? super T&gt; action) &#123; Objects.requireNonNull(action); for (T t : this) &#123; action.accept(t); &#125; &#125; default Spliterator&lt;T&gt; spliterator() &#123; return Spliterators.spliteratorUnknownSize(iterator(), 0); &#125;&#125; è¿™é‡Œé¢åŒ…å«ä¸‰ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­forEachå’Œspliteratorè¿™ä¸¤ä¸ªJava 1.8æ–°å¢çš„defaultæ–¹æ³•ï¼Œå…³äºä»€ä¹ˆæ˜¯defaultæ–¹æ³•ï¼Œå‚è€ƒè¿™é‡Œ,(PS:Javaä¸ºäº†å‘ä¸‹å…¼å®¹ä¹Ÿæ˜¯ç…è´¹è‹¦å¿ƒå•Š:dog:) 1.2 iterator()iterator()æ–¹æ³•æ˜¯Java1.5æ–°å¢çš„ç‰¹æ€§ï¼Œç”¨äºç”ŸæˆIteratorè¿­ä»£å™¨ï¼Œè¿™é‡Œè¯¥æ–¹æ³•åªè´Ÿè´£ç”ŸæˆIteratorè¿­ä»£å™¨ï¼Œå¹¶ä¸åŒ…å«ä»»ä½•è¿­ä»£å™¨çš„çŠ¶æ€ï¼Œä¾‹å¦‚â€œå½“å‰å…ƒç´ â€ç­‰ã€‚ è€ŒIteratorè¿­ä»£å™¨æ˜¯ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ¥å£å­˜åœ¨çš„ã€‚ è¯¥éå†æ˜¯é¡ºåºéå† 1.3 forEach()forEach å¾ˆç†Ÿæ‚‰ ç”¨æ¥æ”¯æŒlambdaè¡¨è¾¾å¼çš„ï¼Œä¾‹å¦‚: 123list.forEach(item-&gt;&#123; doSomething...;&#125;) æˆ‘ä»¬å¯ä»¥çœ‹åˆ° åœ¨Iterableæ¥å£ä¸­é»˜è®¤ç»™å‡ºçš„å®ç°æ˜¯ 123for (T t : this) &#123; action.accept(t);&#125; ä½†æ˜¯è¿™ä¸ªæ–¹æ³•åœ¨å­ç±»ä¸­æ˜¯å¯ä»¥è¢«è¦†ç›–çš„ï¼Œå¾ˆå¤šé›†åˆéƒ½å¯¹è¯¥æ–¹æ³•è¿›è¡Œäº†é‡å†™æ“ä½œï¼Œä»¥é€‚åº”ä¸åŒé›†åˆçš„ç‰¹æ€§ã€‚ 1.4 spliterator()è¯¥æ¥å£æ˜¯Javaä¸ºäº†å¹¶è¡Œéå†æ•°æ®æºä¸­çš„å…ƒç´ è€Œè®¾è®¡çš„è¿­ä»£å™¨ è¯¥æ–¹æ³•ç±»ä¼¼äºiterator()è¿™ä¸ªæ–¹æ³•ï¼ŒåŒºåˆ«åœ¨äºiterator()æ˜¯é¡ºåºéå†ï¼Œè€Œspliterator()æ˜¯å¹¶è¡Œéå†ï¼Œå…·ä½“å¯ä»¥å‚è€ƒè¿™é‡ŒJava8é‡Œé¢çš„java.util.Spliteratoræ¥å£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ 2.ä»€ä¹ˆæ˜¯Iterator2.1 ç®€ä»‹Iteratoræ˜¯å…·æœ‰è¿­ä»£çŠ¶æ€çš„å¯¹è±¡ï¼Œå³ä»è¯¥ç±»çš„æ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥è·å–å½“å‰è¿­ä»£çš„å…ƒç´ ï¼Œä¸‹ä¸€ä¸ªå…ƒç´ ç­‰æ“ä½œã€‚å®ƒå¯ä»¥æŠŠè®¿é—®é€»è¾‘ä»ä¸åŒç±»å‹çš„é›†åˆç±»ä¸­æŠ½è±¡å‡ºæ¥ï¼Œä»è€Œé¿å…å‘å®¢æˆ·ç«¯æš´éœ²é›†åˆçš„å†…éƒ¨ç»“æ„ã€‚Iteratorçš„å®šä¹‰å¦‚ä¸‹ï¼š 1234567891011121314151617181920package java.util;import java.util.function.Consumer;public interface Iterator&lt;E&gt; &#123; boolean hasNext(); E next(); default void remove() &#123; throw new UnsupportedOperationException(\"remove\"); &#125; default void forEachRemaining(Consumer&lt;? super E&gt; action) &#123; Objects.requireNonNull(action); while (hasNext()) action.accept(next()); &#125;&#125; 2.2 hasNext()æ¥å£è§£é‡Šï¼šç”¨äºåˆ¤æ–­è¿­ä»£å™¨(iteration)ä¸­æ˜¯å¦è¿˜æœ‰æ›´å¤šçš„å…ƒç´ (elements)ã€‚å¦‚æœè¿­ä»£å™¨ä¸­è¿˜æœ‰æ›´å¤šçš„å…ƒç´ åˆ™è¿”å›trueã€‚ 2.3 next()æ¥å£è§£é‡Šï¼šç”¨äºè·å–è¿­ä»£å™¨ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ (next element)ï¼Œè¿™é‡Œå¦‚æœä¸‹ä¸€ä¸ªå…ƒç´ ä¸å­˜åœ¨ä¼šæŠ›å‡ºä¸€ä¸ªNoSuchElementExceptionçš„å¼‚å¸¸ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•é€šå¸¸ç»“åˆhasNext()ä¸€èµ·ä½¿ç”¨ã€‚ 2.4 remove():star::star:æ¥å£è§£é‡Šï¼šç”¨äºä»é›†åˆä¸­ç§»é™¤è¿­ä»£å™¨è¿”å›çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚è¿™ä¸ªæ–¹æ³•åªèƒ½åœ¨next()æ–¹æ³•ä¹‹åè¿›è¡Œè°ƒç”¨ä¸€æ¬¡ è¿™ä¸ªæ–¹æ³•ä¼šæŠ›å‡ºä¸¤ä¸ªå¼‚å¸¸ UnsupportedOperationException:è¡¨ç¤ºå½“å‰è¿­ä»£å™¨ä¸æ”¯æŒç§»é™¤æ“ä½œã€‚ IllegalStateException:è¡¨ç¤ºnext()æ–¹æ³•å°šæœªæ‰§è¡Œ æˆ– next()æ–¹æ³•åå·²ç»æ‰§è¡Œäº†remove()æ–¹æ³•ã€‚ è¿™é‡Œæœ‰ä¸¤ä¸ªä¾‹å­ï¼Œå¦‚ä½•åœ¨é›†åˆä¸­ç§»é™¤ä¸€ä¸ªå…ƒç´ çš„æ“ä½œã€‚ é”™è¯¯ç¤ºèŒƒ:x:: 123456List&lt;String&gt; list = Lists.newArrayList(\"A\",\"B\",\"C\",\"D\");for (String s : list) &#123; if (Objects.equals(\"A\",s))&#123; list.remove(s); &#125;&#125; è¿™é‡Œä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸java.util.ConcurrentModificationExceptionï¼Œè¡¨ç¤º æ–¹æ³•æ£€æµ‹åˆ°å¯¹è±¡çš„å¹¶å‘ä¿®æ”¹ï¼Œä½†æ˜¯è¿™ç§ä¿®æ”¹å¹¶ä¸è¢«å…è®¸ã€‚ äº§ç”Ÿçš„åŸå› å°±æ˜¯è¿­ä»£å™¨æ˜¯ä¾èµ–äºé›†åˆè€Œå­˜åœ¨ï¼Œåœ¨åˆ¤æ–­æˆåŠŸåï¼Œé›†åˆçš„ä¸­ç§»é™¤äº†è¯¥å…ƒç´ ï¼Œè€Œè¿­ä»£å™¨å´ä¸çŸ¥é“ï¼Œæ‰€ä»¥å°±æŠ¥é”™äº†ï¼Œè¿™ä¸ªé”™å«å¹¶å‘ä¿®æ”¹å¼‚å¸¸ã€‚ æ­£ç¡®æ“ä½œâœ…: 12345678List&lt;String&gt; list = Lists.newArrayList(\"A\", \"B\", \"C\", \"D\");Iterator&lt;String&gt; it = list.iterator();while (it.hasNext()) &#123; String str = it.next(); if (Objects.equals(\"A\", str)) &#123; it.remove(); &#125;&#125; åœ¨Java8ä¸­ä¸Šé¢çš„ä»£ç å¯ä»¥ç”¨ä¸‹é¢ä¸¤è¡Œæ¥å®Œæˆï¼š 12List&lt;String&gt; list = Lists.newArrayList(\"A\", \"B\", \"C\", \"D\");list.removeIf(str -&gt; Objects.equals(\"A\", str)); è¿™ä¸¤ç§æ–¹å¼éƒ½æ˜¯å¯ä»¥æ­£ç¡®çš„å®Œæˆæˆ‘ä»¬æ‰€éœ€è¦çš„æ“ä½œçš„ã€‚ 2.5 forEachRemaining()è¿™ä¸ªæ–¹æ³•æ˜¯1.8æ–°å¢çš„æ–¹æ³•ï¼Œå¯¹æ¯ä¸ªå‰©ä½™çš„å…ƒç´ æ‰§è¡Œç»™å®šçš„æ“ä½œï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ éƒ½æ‰§è¡Œå®Œæˆæˆ–è€…æŠ›å‡ºå¼‚å¸¸ã€‚ å¦‚æœä¼ å…¥çš„æ“ä½œ(Consumer&lt;? super E&gt; action)ä¸ºç©ºçš„è¯ï¼Œè¯¥æ–¹æ³•ä¼šæŠ›å‡ºä¸€ä¸ªNullPointerException 3.Iteratorçš„å®ç°æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Iteratoræä¾›äº†æœ€ç®€å•çš„å‘åéå†çš„æ“ä½œæ¥å£ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ‰§è¡Œå‘å‰éå†å‘¢ï¼Ÿæˆ–è€…æ‰§è¡ŒæŸäº›ç‰¹æ®Šçš„éå†æ–¹å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±è¦çœ‹ä¸åŒé›†åˆå¯¹Iteratorçš„å®ç°äº†ï¼Œä¸åŒé›†åˆçš„å¯¹äºIteratorçš„å®ç°åŸºæœ¬éƒ½æ˜¯é€šè¿‡å†…éƒ¨ç±»æ¥åšçš„å®ç°ã€‚ 3.1 ArrayListä¸­Iteratorçš„å®ç°3.1.1 Itråœ¨ArrayListä¸­ï¼Œiterator()æ–¹æ³•è¢«è¿”å›äº†ä¸€ä¸ªItrçš„å¯¹è±¡ã€‚ 1234// ArrArrayList.javapublic Iterator&lt;E&gt; iterator() &#123; return new Itr();&#125; è¿™ä¸ªItrå¯¹è±¡å°±æ˜¯å¯¹ArrayListå¯¹Iteratorçš„å®ç°ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889private class Itr implements Iterator&lt;E&gt; &#123; // è¢«è¿”å›çš„èŠ‚ç‚¹çš„ç´¢å¼• int cursor; // index of next element to returnã€ // æœ€åä¸€ä¸ªè¢«è¿”å›çš„èŠ‚ç‚¹çš„ç´¢å¼• int lastRet = -1; // index of last element returned; -1 if no such // expectedModCount æœŸæœ›çš„è¢«ä¿®æ”¹çš„æ¬¡æ•°ï¼Œ // modCount è¢«ä¿®æ”¹çš„æ¬¡æ•°,è¿™ä¸ªä¸‹é¢ä¼šç”¨å¾—åˆ°ã€‚å®šä¹‰modCountçš„æ³¨é‡Šç¿»è¯‘å¯ä»¥å‚è€ƒ[è¿™é‡Œ](https://blog.csdn.net/qq_27093465/article/details/53116250) int expectedModCount = modCount; /** * åˆ¤æ–­æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ,å¦‚æœå½“å‰æ¸¸æ ‡æ‰€åœ¨ä½ç½®ä¸ç­‰äºé›†åˆçš„å¤§å°çš„æ—¶å€™éƒ½ä¼šè¿”å›true. */ public boolean hasNext() &#123; return cursor != size; &#125; /** * nextæ“ä½œ */ public E next() &#123; // æ ¡éªŒæ˜¯å¦è¢«éæ³•ä¿®æ”¹ checkForComodification(); int i = cursor; // å½“å‰æ¸¸æ ‡å¤§äºç­‰äºé›†åˆçš„å¤§å°çš„æ—¶å€™ æŠ›å‡ºå¼‚å¸¸ if (i &gt;= size) throw new NoSuchElementException(); // å­˜å‚¨ArrayListçš„æ•°ç»„ç¼“å†²åŒºçš„å¤§å° Object[] elementData = ArrayList.this.elementData; // å¦‚æœæ¸¸æ ‡å¤§äºç­‰äºæ•°ç»„ç¼“å†²åŒºçš„å¤§å°åˆ™æŠ›å‡ºå¼‚å¸¸ if (i &gt;= elementData.length) throw new ConcurrentModificationException(); // æ¸¸æ ‡+1 cursor = i + 1; // è·å–å¯¹åº”ä¸‹è¡¨çš„å†…å®¹ï¼Œè¿›è¡Œå¼ºè½¬ï¼Œ å¹¶å°†å½“å‰è®¿é—®çš„èŠ‚ç‚¹è®°å½•åˆ°lastRetä¸­ï¼Œ return (E) elementData[lastRet = i]; &#125; /** * ç§»é™¤æ“ä½œ */ public void remove() &#123; // lastRetå°äº0ï¼Œå³è¡¨ç¤ºæ²¡æœ‰æ‰§è¡Œnextæ“ä½œï¼Œä¹Ÿå°±æ˜¯ä¸å­˜åœ¨å½“å‰å…ƒç´ ã€‚ if (lastRet &lt; 0) throw new IllegalStateException(); // æ ¡éªŒæ˜¯å¦è¢«éæ³•ä¿®æ”¹ checkForComodification(); try &#123; // å°†æœ€åä¸€æ¬¡è®¿é—®çš„èŠ‚ç‚¹ç§»é™¤ ArrayList.this.remove(lastRet); // æ›´æ–° æ¸¸æ ‡ï¼ŒğŸ˜ˆæˆ‘ä»¬ç›´æ¥æ‰§è¡Œlistä¸­çš„removeæ–¹æ³•å°±æ˜¯å› ä¸ºæ²¡æœ‰æ›´æ–°æ¸¸æ ‡å’ŒexpectedModCountï¼Œæ‰€ä»¥æ— æ³•é€šè¿‡æ ¡éªŒã€‚ cursor = lastRet; // æ›´æ”¹æœ€åä¸€æ¬¡è®¿é—®çš„ç´¢å¼•ä¸º-1ï¼Œæ­¤å¤„å› ä¸ºæœ€åä¸€æ¬¡è®¿é—®çš„å…ƒç´ å·²ç»ä¸å­˜åœ¨äº†ï¼Œæ‰€ä»¥æ›´æ–°ä¸º-1ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é¿å…å†æ¬¡è°ƒç”¨removeæ–¹æ³•ã€‚ lastRet = -1; // æ›´æ–°ä¿®æ”¹æ¬¡æ•° expectedModCount = modCount; &#125; catch (IndexOutOfBoundsException ex) &#123; // æ•è·removeè¿‡ç¨‹ä¸­å‡ºç°çš„æ•°ç»„ä¸‹æ ‡è¶Šç•Œå¼‚å¸¸ï¼Œæ›´æ”¹ä¸ºéæ³•ä¿®æ”¹å¼‚å¸¸ã€‚ throw new ConcurrentModificationException(); &#125; &#125; @Override public void forEachRemaining(Consumer&lt;? super E&gt; consumer) &#123; Objects.requireNonNull(consumer); final int size = ArrayList.this.size; int i = cursor; if (i &gt;= size) &#123; return; &#125; final Object[] elementData = ArrayList.this.elementData; if (i &gt;= elementData.length) &#123; throw new ConcurrentModificationException(); &#125; while (i != size &amp;&amp; modCount == expectedModCount) &#123; consumer.accept((E) elementData[i++]); &#125; // update once at end of iteration to reduce heap write traffic cursor = i; lastRet = i - 1; checkForComodification(); &#125; // final é˜²æ­¢è¿™ä¸ªæ–¹æ³•è¢«éæ³•ä¿®æ”¹ final void checkForComodification() &#123; // æ ¡éªŒä¿®æ”¹æ¬¡æ•°å’ŒæœŸæœ›çš„ä¿®æ”¹æ¬¡æ•°æ˜¯å¦ç›¸åŒï¼Œremoveæ˜¯ä¸€ä¸ªå…¸å‹çš„ä¾‹å­ã€‚Iträ¸­çš„removeæ–¹æ³•æ›´æ–°äº†expectedModCountï¼Œè€Œlistä¸­removeæ–¹æ³•å¹¶æ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Iteratorè¿›è¡Œéå†åˆ é™¤ã€‚ if (modCount != expectedModCount) throw new ConcurrentModificationException(); &#125;&#125; 3.1.1 ListItråœ¨ArrayListä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªlistIterator()æ–¹æ³•è¢«è¿”å›äº†ä¸€ä¸ªListIteratorçš„å¯¹è±¡ã€‚é‚£ä¹ˆè¿™ä¸ªå¯¹è±¡æ˜¯å¹²å•¥çš„å‘¢ï¼Ÿ 1234567891011121314/** * ä»æŒ‡å®šä½ç½®å¼€å§‹è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¦‚æœä½ç½®è¶…è¿‡äº†Listçš„å¤§å°ï¼Œåˆ™æŠ›å‡ºIndexOutOfBoundsException */public ListIterator&lt;E&gt; listIterator(int index) &#123; if (index &lt; 0 || index &gt; size) throw new IndexOutOfBoundsException(\"Index: \"+index); return new ListItr(index);&#125;/** * è¿”å›ä¸€ä¸ªä»0å¼€å§‹çš„è¿­ä»£å™¨ */public ListIterator&lt;E&gt; listIterator() &#123; return new ListItr(0);&#125; è¿™ä¸ªæ–¹æ³•åœ¨ItråŸºç¡€ä¸Šæä¾›äº†ä¸€äº›Listé›†åˆç‰¹æœ‰çš„éå†æ–¹æ³•ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172// ç»§æ‰¿äº†Itrï¼Œå®ç°äº†ListIteratoræ¥å£ï¼ŒListIteratoræ¥å£ä¸­å®šä¹‰äº†Listé›†åˆä¸€äº›ç‰¹æœ‰çš„éå†æ–¹æ³•private class ListItr extends Itr implements ListIterator&lt;E&gt; &#123; // æ„é€ æ–¹æ³•ï¼Œå¯ä»¥æŒ‡å®šè¿­ä»£å™¨çš„èµ·å§‹ä½ç½®ï¼Œå³cursorçš„ä½ç½® ListItr(int index) &#123; super(); cursor = index; &#125; // æ˜¯å¦æœ‰å‰ä¸€ä¸ªå…ƒç´  public boolean hasPrevious() &#123; // åˆ¤æ–­æ¸¸æ ‡æ˜¯å¦æ˜¯åœ¨æœ€å‰é¢ return cursor != 0; &#125; // åä¸€ä¸ªå…ƒç´ çš„ä½ç½® public int nextIndex() &#123; return cursor; &#125; // å‰ä¸€ä¸ªå…ƒç´ çš„ä½ç½® public int previousIndex() &#123; return cursor - 1; &#125; // å‰ä¸€ä¸ªå…ƒç´  public E previous() &#123; // æ ¡éªŒæ˜¯å¦è¢«éæ³•ä¿®æ”¹(Iträ¸­çš„æ–¹æ³•) checkForComodification(); // ç¡®å®šå‰ä¸€ä¸ªå…ƒç´ çš„ä½ç½® int i = cursor - 1; // å‰ä¸€ä¸ªå…ƒç´ å¦‚æœå°äº0åˆ™è¡¨ç¤ºå½“å‰æ˜¯èµ·å§‹èŠ‚ç‚¹ï¼Œä¸Šä¸€ä¸ªèŠ‚ç‚¹ä¸å­˜åœ¨ã€‚ if (i &lt; 0) throw new NoSuchElementException(); // å‰©ä¸‹çš„å’Œnext()åŒç† Object[] elementData = ArrayList.this.elementData; if (i &gt;= elementData.length) throw new ConcurrentModificationException(); cursor = i; return (E) elementData[lastRet = i]; &#125; // æ›¿æ¢å½“å‰å…ƒç´  public void set(E e) &#123; // åˆ¤æ–­å½“å‰å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼ŒåŒç†çš„ç±»ä¼¼äºremove() if (lastRet &lt; 0) throw new IllegalStateException(); // æ ¡éªŒæ˜¯å¦è¢«éæ³•ä¿®æ”¹ checkForComodification(); try &#123; // ä¿®æ”¹ç¼“å†²åŒºæ•°ç»„çš„å€¼ ArrayList.this.set(lastRet, e); &#125; catch (IndexOutOfBoundsException ex) &#123; throw new ConcurrentModificationException(); &#125; &#125; // å¢åŠ ä¸€ä¸ªå€¼(åŸç†åŒremove()) public void add(E e) &#123; checkForComodification(); try &#123; int i = cursor; ArrayList.this.add(i, e); cursor = i + 1; lastRet = -1; expectedModCount = modCount; &#125; catch (IndexOutOfBoundsException ex) &#123; throw new ConcurrentModificationException(); &#125; &#125;&#125; 4.è¿­ä»£å™¨æ¨¡å¼å®ç°äº†Iterableæ¥å£çš„ç±»æ˜¯å¯è¿­ä»£çš„ï¼›å®ç°äº†Iteratoræ¥å£çš„ç±»æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ã€‚ è¿™é‡Œç®—æ˜¯ä¸€ä¸ªè¿­ä»£å™¨æ¨¡å¼ï¼Œå³æä¾›ä¸€ç§æ–¹æ³•è®¿é—®ä¸€ä¸ªå®¹å™¨å¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚ã€‚ 4.1 ç±»å›¾ è¿­ä»£å™¨ç±»å›¾ 4.2 è¿­ä»£å™¨æ¨¡å¼çš„ç»“æ„ æŠ½è±¡å®¹å™¨(Aggregate):é€šå¸¸æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæä¾›iterator()æ–¹æ³•ï¼Œæ¯”å¦‚è¯´Javaä¸­çš„Iteratoræ¥å£ï¼ŒCollectionæ¥å£ï¼ŒSetæ¥å£ç­‰ã€‚ å…·ä½“å®¹å™¨(ConcreteAggregate):æŠ½è±¡å®¹å™¨çš„å…·ä½“å®ç°ç±»ï¼Œæ¯”å¦‚è¯´ArrayListï¼ŒLinkListï¼ŒHashSetç­‰ã€‚ æŠ½è±¡è¿­ä»£å™¨(Iterator):å®šä¹‰éå†å…ƒç´ æ‰€éœ€è¦çš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯´ï¼šnext()ï¼ŒhasNext()ï¼Œremove()ç­‰æ–¹æ³•ã€‚ è¿­ä»£å™¨å®ç°(ConcreteIterator):å®ç°è¿­ä»£å™¨æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå®Œæˆé›†åˆçš„è¿­ä»£ã€‚","tags":[{"name":"JDKæºç ","slug":"JDKæºç ","permalink":"http://xiaomogu.me/tags/JDKæºç /"},{"name":"JavaåŸºç¡€","slug":"JavaåŸºç¡€","permalink":"http://xiaomogu.me/tags/JavaåŸºç¡€/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://xiaomogu.me/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"Dockerfileä¸­`ADD`å’Œ`COPY`çš„åŒºåˆ«","date":"2018-04-10T09:34:54.000Z","path":"2018/04/10/Dockerfileä¸­`ADD`å’Œ`COPY`çš„åŒºåˆ«/","text":"Dockerfileä¸­ADDå’ŒCOPYçš„åŒºåˆ« æœ¬æ–‡æ¥è‡ªBest practices for writing Dockerfiles å»ºè®®ç¼–å†™Dockerfileå‰å…ˆç†Ÿè¯»ä¸Šæ–‡ Dockerfile ä¸­æä¾›äº†ä¸¤ç§å¤åˆ¶æ–‡ä»¶çš„æ–¹å¼ï¼šADDå’ŒCOPYï¼Œè¿™ä¸¤ç§æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿè¿™ä¸¤è€…åˆ†åˆ«åœ¨ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å‘¢? ADDå’ŒCOPYåŠŸèƒ½ç›¸ä¼¼ï¼ŒCOPYæ˜¯é¦–é€‰ã€‚å› ä¸ºå®ƒæ¯”ADDæ›´åŠ é€æ˜.COPYä»…æ”¯æŒåŸºç¡€çš„æœ¬åœ°æ–‡ä»¶æ‹·è´åˆ°å®¹å™¨ä¸­ï¼ŒADDæœ‰äº›ç‰¹æ€§(æœ¬åœ°taråŒ…è§£å‹å’Œè¿œç¨‹URLæ”¯æŒ) ï¼Œè¿™äº›ç‰¹æ€§å¹¶ä¸æ˜¯å¾ˆæ˜æ˜¾ã€‚ADDæœ€å¥½çš„åº”ç”¨æ˜¯æœ¬åœ°taråŒ…è‡ªåŠ¨è§£å‹åˆ°é•œåƒä¸­ï¼Œå¦‚ADD rootfs.tar.xz /ã€‚ å¦‚æœæˆ‘ä»¬åœ¨Dockerfileä¸­æœ‰å¤šä¸ªæ­¥éª¤ä½¿ç”¨ä¸åŒæ–‡ä»¶ï¼Œé€ä¸ªCOPYè¿™äº›æ–‡ä»¶ï¼Œè€Œä¸æ˜¯æ‹·è´æ‰€æœ‰æ–‡ä»¶ã€‚è¿™æ ·ç¡®ä¿æ¯æ­¥éª¤çš„ç¼“å­˜ä¼šè¿˜é‡æ–°æ›´æ–°ã€‚ 123COPY requirements.txt /tmp/RUN pip install --requirement /tmp/requirements.txtCOPY . /tmp/ å‡ºäºé•œåƒå¤§å°è€ƒè™‘ï¼Œå¼ºçƒˆä¸å»ºè®®ä½¿ç”¨ADDè·å–è¿œç¨‹URLåœ°å€çš„åŒ…ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨curlæˆ–è€…wgetæ›¿ä»£ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥åœ¨è§£å‹ååˆ é™¤ä¸ç”¨çš„æ–‡ä»¶ï¼Œè€Œä¸å¿…æ·»åŠ åˆ°é•œåƒçš„å¦ä¸€å±‚ã€‚æˆ‘ä»¬é¿å…ä½¿ç”¨å¦‚ä¸‹å½¢å¼: 123ADD http://example.com/big.tar.xz /usr/src/things/RUN tar -xJf /usr/src/things/big.tar.xz -C /usr/src/thingsRUN make -C /usr/src/things all åº”è¯¥æ›¿æ¢æˆå¦‚ä¸‹å½¢å¼: 1234RUN mkdir -p /usr/src/things \\ &amp;&amp; curl -SL http://example.com/big.tar.xz \\ | tar -xJC /usr/src/things \\ &amp;&amp; make -C /usr/src/things all","tags":[{"name":"Docker","slug":"Docker","permalink":"http://xiaomogu.me/tags/Docker/"},{"name":"Dockerfile","slug":"Dockerfile","permalink":"http://xiaomogu.me/tags/Dockerfile/"}]},{"title":"Dockerfile å¯¼å…¥è¯ä¹¦åˆ°JAVAçš„ç§˜é’¥åº“ä¸­","date":"2018-04-10T01:07:41.652Z","path":"2018/04/10/Dockerfile å¯¼å…¥è¯ä¹¦åˆ°JAVAçš„ç§˜é’¥åº“ä¸­/","text":"Dockerfile å¯¼å…¥è¯ä¹¦åˆ°JAVAçš„ç§˜é’¥åº“ä¸­ç›®çš„:å°†å·²æœ‰çš„CAè¯ä¹¦å¯¼å…¥åˆ°é€šè¿‡Dockerfileå¯¼å…¥åˆ°JAVAçš„ç§˜é’¥åº“ä¸­ã€‚ 12345678FROM custom/oraclejdk:8-jre8COPY ./tomcat.cer /tomcat.cerRUN $JAVA_HOME/bin/keytool -storepasswd -new mysecretpassword -keystore $JAVA_HOME/jre/lib/security/cacerts -storepass changeit &amp;&amp; \\ echo 'yes' | $JAVA_HOME/bin/keytool -import -alias passport.sso.com -keystore $&#123;JAVA_HOME&#125;/jre/lib/security/cacerts -file /tomcat.cer -trustcacerts -storepass mysecretpasswordCOPY ./uums.jar /home/uums.jarCMD [\"java\",\"-Dspring.profiles.active=test\",\"-jar\",\"/home/uums.jar\"] è§£é‡Šï¼š 1$JAVA_HOME/bin/keytool -storepasswd -new mysecretpassword -keystore $JAVA_HOME/jre/lib/security/cacerts -storepass changeit ä¸Šé¢è¿™å¥è¯çš„ç›®çš„æ˜¯å°†changeitè¿™ä¸ªå¯†ç å­˜å‚¨åˆ°ç§˜é’¥åº“ä¸­ 1echo 'yes' | $JAVA_HOME/bin/keytool -import -alias passport.sso.com -keystore $&#123;JAVA_HOME&#125;/jre/lib/security/cacerts -file /tomcat.cer -trustcacerts -storepass mysecretpassword æ­¤å¤„æ˜¯å¯¼å…¥è¯ä¹¦ï¼Œ-storepass mysecretpassword,è¿™å¥è¯æ˜¯æŒ‡å®šæˆ‘ä»¬ä¸Šä¸€æ­¥å­˜å‚¨çš„å¯†ç åç§°ã€‚è¿™ä¸€è¡Œå¦‚æœå•ç‹¬æ‰§è¡Œçš„è¯æ˜¯éœ€è¦è¾“å…¥yesæ¥ä¿¡ä»»è¯¥è¯ä¹¦çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡echo &#39;yes&#39;è¿™ç§å†™æ³•æ¥å®ç°yesçš„è‡ªåŠ¨è¾“å…¥ã€‚ å‚è€ƒï¼š Inserting certificates into Java keystore via Dockerfile javaä¸­Keytoolçš„ä½¿ç”¨æ€»ç»“","tags":[{"name":"Docker","slug":"Docker","permalink":"http://xiaomogu.me/tags/Docker/"},{"name":"Dockerfile","slug":"Dockerfile","permalink":"http://xiaomogu.me/tags/Dockerfile/"}]},{"title":"Mybatis åˆå§‹åŒ–è¿‡ç¨‹","date":"2018-03-19T06:27:59.401Z","path":"2018/03/19/Mybatis åˆå§‹åŒ–è¿‡ç¨‹/","text":"Mybatis åˆå§‹åŒ–è¿‡ç¨‹ Mybatisçš„åˆå§‹åŒ–å°±æ˜¯å°†Mybatisçš„é…ç½®ä¿¡æ¯åŠ è½½åˆ°Configurationè¿™ä¸ªç±»ä¸­ï¼Œä»¥ä¾¿åé¢çš„ä½¿ç”¨ã€‚ Mybatisçš„åˆå§‹åŒ–æµç¨‹ï¼Œä¸‹é¢æ˜¯ä¸€æ®µMybatisä»åŠ è½½é…ç½®åˆ°æ‰§è¡ŒSQLè¯­å¥çš„å®Œæ•´è¿‡ç¨‹çš„ä»£ç (è¯¥ä»£ç æ¥è‡ªMybatisçš„æµ‹è¯•ç±») Mybatisæµ‹è¯•ä»£ç 1 ä¸‹é¢æˆ‘ä»¬æ¥ä¸€æ­¥ä¸€æ­¥çš„åˆ†æ è¯»å–é…ç½®æ–‡ä»¶ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é¦–å…ˆä½¿ç”¨çš„æ˜¯Resourcesè¿™ä¸ªç±»è¯»å–çš„é…ç½®æ–‡ä»¶ï¼Œä»¥æµçš„å½¢å¼è¯»å–åˆ°ç¨‹åºä¸­ï¼Œè¿”å›ä¸€ä¸ªReaderã€‚ åŠ è½½é…ç½®æ–‡ä»¶ è¿™ä¸€æ­¥å°†ä¸Šé¢è¯»å–çš„readerä½œä¸ºå‚æ•°ä¼ é€’ç»™SqlSessionFactoryBuilderç”¨äºæ„å»ºSqlSessionFactoryã€‚ SqlSessionFactoryBuilder è¯¥ç±»æä¾›äº†è®¸å¤šé‡è½½çš„æ–¹æ³•ä¾›æˆ‘ä»¬é€‰æ‹©ã€‚ æ­¤ç±»çš„æ ¸å¿ƒå°±æ˜¯å°†æˆ‘ä»¬ä¼ å…¥çš„Readeræˆ–è€…InputStreamé€šè¿‡XMLConfigBuilderç±»çš„parseæ–¹æ³•ï¼Œæ„é€ æˆConfigurationï¼Œç„¶åé€šè¿‡ç¬¬91è¡Œçš„buildæ–¹æ³•ï¼Œæ„é€ ä¸€ä¸ªSqlSessionFactoryå¹¶è¿”å›ã€‚ é…ç½®æ–‡ä»¶è§£æè¿‡ç¨‹ 12XMLConfigBuilder parser = new XMLConfigBuilder(inputStream, environment, properties);return build(parser.parse()); é…ç½®æ–‡ä»¶è§£æçš„å…¥å£å°±æ˜¯åœ¨è¿™é‡Œã€‚æ ¹æ®è¯»å–é…ç½®æ–‡ä»¶æ—¶ä¼ å…¥çš„Readeræˆ–è€…InputStreamåˆ†åˆ«è°ƒç”¨XMLConfigBuilderä¸åŒçš„æ„é€ å™¨ï¼Œå®ä¾‹åŒ–å‡ºXMLConfigBuilder,ç„¶åè°ƒç”¨XMLConfigBuilderç±»ä¸­çš„parse()æ–¹æ³•,æ„é€ å‡ºæˆ‘ä»¬éœ€è¦çš„Configurationã€‚ 123public XMLConfigBuilder(InputStream inputStream, String environment, Properties props) &#123; this(new XPathParser(inputStream, true, props, new XMLMapperEntityResolver()), environment, props);&#125; è¿™æ˜¯æ„å»ºXMLConfigBuilderçš„å…·ä½“æ–¹æ³•ã€‚è¿™ä¸ªåœ°æ–¹çš„æ„é€ è¿‡ç¨‹å¦‚ä¸‹ å…ˆå®ä¾‹åŒ–XMLMapperEntityResolver,ç„¶åå°†å…¶ä½œä¸ºå®ä¾‹åŒ–XPathParserçš„å‚æ•°ä¹‹ä¸€ï¼Œæœ€åå®ä¾‹åŒ–XMLConfigBuilder å®ä¾‹åŒ–XMLMapperEntityResolverçš„è¿‡ç¨‹å¾ˆç®€å•ï¼Œè°ƒç”¨çš„æ˜¯å…¶æ— å‚æ„é€ å‡½æ•°ï¼ŒXMLMapperEntityResolveré‡Œé¢åŒ…å«äº†ä¸€äº›Mybatisçš„DTDã€‚è¯¥ç±»å¯¹å¤–æš´éœ²äº†ä¸€ä¸ªpublic InputSource resolveEntity(String publicId, String systemId)çš„æ–¹æ³•ï¼Œç”¨äºå¯»æ‰¾æ ¹æ®publicIdå’ŒsystemId,å¯»æ‰¾å¯¹åº”çš„DTDæ–‡ä»¶ã€‚ å®ä¾‹åŒ–XPathParser 1234public XPathParser(InputStream inputStream, boolean validation, Properties variables, EntityResolver entityResolver) &#123; commonConstructor(validation, variables, entityResolver); this.document = createDocument(new InputSource(inputStream));&#125; inputStreamå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„é…ç½®æ–‡ä»¶çš„æµçš„ä¿¡æ¯ï¼ŒentityResolveræ˜¯æˆ‘ä»¬åˆšåˆšå®ä¾‹åŒ–çš„XMLMapperEntityResolverã€‚é¦–å…ˆè°ƒç”¨äº†commonConstructor 12345678private void commonConstructor(boolean validation, Properties variables, EntityResolver entityResolver) &#123; this.validation = validation; this.entityResolver = entityResolver; this.variables = variables; // å®ä¾‹åŒ–ä¸€ä¸ªXPathå·¥å‚ï¼Œç”¨äºç”Ÿäº§XPath XPathFactory factory = XPathFactory.newInstance(); this.xpath = factory.newXPath();&#125; æ‰§è¡Œå®ŒcommonConstructorä¹‹åå°±æ˜¯åˆ›å»ºDocumentäº†,è¿™ä¸€å—æ²¡å•¥é‡ç‚¹ï¼Œè§£æXMLæˆDocumentå¯¹è±¡è€Œå·²ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738private Document createDocument(InputSource inputSource) &#123; // important: this must only be called AFTER common constructor try &#123; // åˆ›å»ºä¸€ä¸ªç”¨äºåˆ›å»ºDocumentBuilderçš„å·¥å‚ï¼Œå¹¶ç»™å·¥å‚è®¾ç½®ä¸€äº›å‚æ•° DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance(); factory.setValidating(validation); factory.setNamespaceAware(false); factory.setIgnoringComments(true); factory.setIgnoringElementContentWhitespace(false); factory.setCoalescing(false); factory.setExpandEntityReferences(true); // é€šè¿‡å·¥å‚åˆ›å»ºä¸€ä¸ªç”¨äºåˆ›å»ºDocumentçš„builder DocumentBuilder builder = factory.newDocumentBuilder(); // è®¾ç½®ä¸€äº›å‚æ•° builder.setEntityResolver(entityResolver); builder.setErrorHandler(new ErrorHandler() &#123; @Override public void error(SAXParseException exception) throws SAXException &#123; throw exception; &#125; @Override public void fatalError(SAXParseException exception) throws SAXException &#123; throw exception; &#125; @Override public void warning(SAXParseException exception) throws SAXException &#123; &#125; &#125;); // è§£æè¾“å…¥çš„æµåˆ›å»ºDocument return builder.parse(inputSource); &#125; catch (Exception e) &#123; throw new BuilderException(\"Error creating document instance. Cause: \" + e, e); &#125;&#125; éƒ½åˆ›å»ºå®Œäº†ï¼Œæˆ‘ä»¬å†å›åˆ°çœŸæ­£æ‰§è¡ŒXMLConfigBuilderåˆ›å»ºçš„æ–¹æ³•ã€‚ 1234567891011private XMLConfigBuilder(XPathParser parser, String environment, Properties props) &#123; // é€šè¿‡çˆ¶ç±»è°ƒç”¨Configurationçš„æ— å‚æ„é€ æ–¹æ³• super(new Configuration()); ErrorContext.instance().resource(\"SQL Mapper Configuration\"); this.configuration.setVariables(props); // ç¡®ä¿åªæ‰§è¡Œä¸€æ¬¡ï¼Œè°ƒç”¨parse()æ–¹æ³•æ—¶ï¼Œä¼šå°†å…¶è®¾ç½®ä¸ºtrue this.parsed = false; this.environment = environment; // è¿™ä¸ªæ˜¯é‡ç‚¹ï¼Œåé¢ä¼šç”¨åˆ° this.parser = parser;&#125; è‡³äºnew Configuration()å…·ä½“å¹²äº†å•¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æºç ã€‚ 123456789101112131415161718192021222324252627282930313233public Configuration() &#123; typeAliasRegistry.registerAlias(\"JDBC\", JdbcTransactionFactory.class); typeAliasRegistry.registerAlias(\"MANAGED\", ManagedTransactionFactory.class); typeAliasRegistry.registerAlias(\"JNDI\", JndiDataSourceFactory.class); typeAliasRegistry.registerAlias(\"POOLED\", PooledDataSourceFactory.class); typeAliasRegistry.registerAlias(\"UNPOOLED\", UnpooledDataSourceFactory.class); typeAliasRegistry.registerAlias(\"PERPETUAL\", PerpetualCache.class); typeAliasRegistry.registerAlias(\"FIFO\", FifoCache.class); typeAliasRegistry.registerAlias(\"LRU\", LruCache.class); typeAliasRegistry.registerAlias(\"SOFT\", SoftCache.class); typeAliasRegistry.registerAlias(\"WEAK\", WeakCache.class); typeAliasRegistry.registerAlias(\"DB_VENDOR\", VendorDatabaseIdProvider.class); typeAliasRegistry.registerAlias(\"XML\", XMLLanguageDriver.class); typeAliasRegistry.registerAlias(\"RAW\", RawLanguageDriver.class); typeAliasRegistry.registerAlias(\"SLF4J\", Slf4jImpl.class); typeAliasRegistry.registerAlias(\"COMMONS_LOGGING\", JakartaCommonsLoggingImpl.class); typeAliasRegistry.registerAlias(\"LOG4J\", Log4jImpl.class); typeAliasRegistry.registerAlias(\"LOG4J2\", Log4j2Impl.class); typeAliasRegistry.registerAlias(\"JDK_LOGGING\", Jdk14LoggingImpl.class); typeAliasRegistry.registerAlias(\"STDOUT_LOGGING\", StdOutImpl.class); typeAliasRegistry.registerAlias(\"NO_LOGGING\", NoLoggingImpl.class); typeAliasRegistry.registerAlias(\"CGLIB\", CglibProxyFactory.class); typeAliasRegistry.registerAlias(\"JAVASSIST\", JavassistProxyFactory.class); languageRegistry.setDefaultDriverClass(XMLLanguageDriver.class); languageRegistry.register(RawLanguageDriver.class);&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•ä¸»è¦æ˜¯æ³¨å†Œäº†ä¸€ç³»åˆ—çš„åˆ«åï¼Œè¿™ä¸ªæˆ‘ä»¬å¦è¡Œåˆ†æï¼Œæˆ‘ä»¬å…ˆå¾€ä¸‹çœ‹ã€‚ XMLConfigBuilderå®ä¾‹åŒ–å®Œæˆä»¥åå°±æ˜¯è°ƒç”¨å…¶parse()æ–¹æ³•å®Œæˆä¸€ç³»åˆ—é…ç½®æ–‡ä»¶çš„è§£æï¼Œå’Œå¯¹Configurationçš„è£…é…ã€‚ 123456789101112public Configuration parse() &#123; // ä¿è¯åªè¢«è§£æä¸€æ¬¡ã€‚ if (parsed) &#123; throw new BuilderException(\"Each XMLConfigBuilder can only be used once.\"); &#125; parsed = true; // è§£ææ ¹èŠ‚ç‚¹(è‡³äºè¿™ä¸ªevalNodeæ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Œå¯ä»¥å‚ç…§XPathè§£æxmlç›¸å…³çš„æ–‡ç« ) XNode xNode = parser.evalNode(\"/configuration\"); // è§£ææ ¹èŠ‚ç‚¹ä¸‹é¢çš„å­èŠ‚ç‚¹ parseConfiguration(xNode); return configuration;&#125; 123456789101112131415161718192021private void parseConfiguration(XNode root) &#123; try &#123; //issue #117 read properties first propertiesElement(root.evalNode(\"properties\")); Properties settings = settingsAsProperties(root.evalNode(\"settings\")); loadCustomVfs(settings); typeAliasesElement(root.evalNode(\"typeAliases\")); pluginElement(root.evalNode(\"plugins\")); objectFactoryElement(root.evalNode(\"objectFactory\")); objectWrapperFactoryElement(root.evalNode(\"objectWrapperFactory\")); reflectorFactoryElement(root.evalNode(\"reflectorFactory\")); settingsElement(settings); // read it after objectFactory and objectWrapperFactory issue #631 environmentsElement(root.evalNode(\"environments\")); databaseIdProviderElement(root.evalNode(\"databaseIdProvider\")); typeHandlerElement(root.evalNode(\"typeHandlers\")); mapperElement(root.evalNode(\"mappers\")); &#125; catch (Exception e) &#123; throw new BuilderException(\"Error parsing SQL Mapper Configuration. Cause: \" + e, e); &#125; &#125; è¿™æ˜¯è§£æConfigurationä¸‹é¢çš„11ä¸ªå­èŠ‚ç‚¹ï¼Œå¹¶è£…é…åˆ°Configurationä¸­ï¼Œå…·ä½“è§£æè¿‡ç¨‹å¯ä»¥ç‚¹è¿›å»è¯¦ç»†æŸ¥çœ‹ã€‚ æ‰§è¡Œå®Œæ•´ä¸ªparse()çš„è¿‡ç¨‹ï¼Œè¿”å›Configurationæ•´ä¸ªåˆå§‹åŒ–æµç¨‹ä¹Ÿå°±ç»“æŸäº†ã€‚","tags":[{"name":"Mybatis","slug":"Mybatis","permalink":"http://xiaomogu.me/tags/Mybatis/"}]},{"title":"GitåŸºç¡€å‘½ä»¤","date":"2018-03-01T00:09:58.660Z","path":"2018/03/01/GitåŸºç¡€å‘½ä»¤/","text":"åˆå§‹åŒ–ä»“åº“ 1git init æŸ¥çœ‹ä»“åº“æ—¥å¿— 1git log æŸ¥çœ‹ä»“åº“çŠ¶æ€ 1git status æ·»åŠ æ–‡ä»¶ 1git add filename æ·»åŠ æ‰€æœ‰æ–‡ä»¶ 1git add -A . æäº¤ 1git commit -m \"&lt;commit message&gt;\" æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€ 1git remote add origin &lt;repository URL&gt; æ¨é€åˆ°è¿œç¨‹ä»“åº“ 1git push -u origin master // æ³¨é‡Š:è¿œç¨‹åˆ†æ”¯ä¸ºoriginï¼Œé»˜è®¤çš„æœ¬åœ°åˆ†æ”¯ä¸ºmasterï¼Œ-uæ˜¯è®°ä½æäº¤å‚æ•°ï¼Œä¸‹æ¬¡å¯ä»¥ç›´æ¥ä½¿ç”¨git push è¿›è¡Œæäº¤ æ‹‰å–è¿œç¨‹ä»“åº“ 1git pull origin master // æ³¨é‡Š:åŒä¸Š æŸ¥çœ‹æœ€è¿‘ä¸€æ¬¡æäº¤çš„æ›´æ”¹ 1git diff HEAD //æ³¨é‡Š:HEADä¸ºæŒ‡é’ˆ,diffçš„å¦ä¸€ä¸ªé‡è¦ç”¨é€”æ˜¯æŸ¥çœ‹å·²ç»æš‚å­˜æ–‡ä»¶å†…çš„æ›´æ”¹ã€‚è®°ä½ï¼Œstagedæ–‡ä»¶æ˜¯æˆ‘ä»¬å‘Šè¯‰gitå·²å‡†å¤‡å¥½æäº¤çš„æ–‡ä»¶ã€‚ å–æ¶ˆæš‚å­˜ 1git reset &lt;filename&gt; //æ³¨é‡Š:ä»æš‚å­˜åŒºç§»é™¤æŒ‡å®šæ–‡ä»¶ æ’¤é”€ 1git checkout -- &lt;filename&gt; //æ³¨é‡Š:é‡æ–°æ£€å‡ºæŸä¸ªæ–‡ä»¶ï¼Œæ¢å¤ä¸ºæœ€åä¸€æ¬¡commitçš„çŠ¶æ€ åˆ›å»ºåˆ†æ”¯ 1git branch &lt;new_branch&gt; åˆ‡æ¢åˆ†æ”¯ 1git checkout &lt;branch&gt; åˆ›å»ºå¹¶åˆ‡æ¢åˆ†æ”¯ 1git checkout -b &lt;new_branch&gt; //æ³¨é‡Š:13ã€14ä¸¤æ¡å‘½ä»¤çš„åˆå¹¶ ç§»é™¤æ–‡ä»¶ 1git rm '&lt;filename&gt;' //æ³¨é‡Šï¼šæ­¤æ“ä½œä¼šåŒæ—¶ä»ç£ç›˜ï¼Œæš‚å­˜åŒºç§»é™¤æŒ‡å®šæ–‡ä»¶ åˆå¹¶åˆ†æ”¯åˆ°master 1git merge &lt;branch&gt; ç§»é™¤åˆ†æ”¯ 1git branch -d &lt;branch&gt; ç›¸å…³é“¾æ¥ï¼š try git Pro Git ä¸­æ–‡ç‰ˆ","tags":[{"name":"Git","slug":"Git","permalink":"http://xiaomogu.me/tags/Git/"}]}]